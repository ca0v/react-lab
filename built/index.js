var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();define("common/common",["require","exports","react"],function(e,t,n){"use strict";function r(e){return Object.keys(e).map(function(t){return n.createElement("li",{key:t},t,": ",e[t])})}function o(e){for(var t,n,r=e.length;0!==r;)n=Math.floor(Math.random()*r),r-=1,t=e[r],e[r]=e[n],e[n]=t;return e}function a(e){var t=e.state,r=Object.keys(t).map(function(r){var o=t[r],a={number:{type:"number",value:"valueAsNumber"},"boolean":{type:"checkbox",value:"checked"},string:{type:"text",value:"value"},undefined:{type:"text",value:"value"}},i=a[typeof o]||a.string;return n.createElement("div",null,n.createElement("label",{className:"input"},r),n.createElement("input",{key:r,type:i.type,value:o,checked:o,placeholder:r,onChange:function(t){e.setState((n={},n[r]=t.target[i.value],n));var n}}))});return n.createElement("div",null,r)}t.__esModule=!0,t.dump=r,t.debounce=function(e,t){void 0===t&&(t=200);var n;return function(){var r=function(){clearTimeout(n),e()};clearTimeout(n),n=setTimeout(r,t)}},t.shuffle=o,t.input=a}),define("components/openlayers",["require","exports","react","common/common","openlayers"],function(e,t,n,r,o){"use strict";function a(e,t){var n=new o.layer.Vector({source:new o.source.Vector({url:t,format:new o.format.GeoJSON})});return e.addLayer(n),n}t.__esModule=!0;var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){return n.createElement("span",{className:"toolbar"},this.props.children)},t}(n.PureComponent),s=function(e){function t(t){var n=e.call(this,t)||this;return n.state={target:null},n}return __extends(t,e),t.prototype.trigger=function(e,t){var n=this.state.map;if(n)switch(e){case"refresh":n.getLayers().getArray().filter(function(e){return e instanceof o.layer.Vector}).map(function(e){return e.getSource().changed()});break;case"extent":var r=t;n.getView().fit(r.extent)}},t.prototype.render=function(){var e=this,t=this.state.map,r=function(){return n.createElement(i,null)};if(this.props.controls&&this.props.controls.draw){var o=this.props.controls.draw;r=function(){return n.createElement(i,null,o.point&&n.createElement("button",{className:""+("Point"===e.state.activeDrawingTool?"active":"inactive"),onClick:function(){return t&&e.draw("Point")}},"Point"),o.circle&&n.createElement("button",{className:""+("Circle"===e.state.activeDrawingTool?"active":"inactive"),onClick:function(){return t&&e.draw("Circle")}},"Circle"),o.line&&n.createElement("button",{className:""+("LineString"===e.state.activeDrawingTool?"active":"inactive"),onClick:function(){return t&&e.draw("LineString")}},"Line"),o.polygon&&n.createElement("button",{className:""+("Polygon"===e.state.activeDrawingTool?"active":"inactive"),onClick:function(){return t&&e.draw("Polygon")}},"Polygon"))}}return n.createElement("div",{className:"maplet "+(this.props.className||"")+" "+(this.props.orientation||"")},this.props.title&&n.createElement("label",null,this.props.title),n.createElement("div",{className:"map",ref:function(t){return e.setState({target:t})}}),n.createElement(r,null),this.props.children)},t.prototype.componentDidMount=function(){var e=this,t=new o.Map({view:new o.View({center:this.props.center||o.proj.fromLonLat([0,0]),zoom:this.props.zoom||0}),controls:[],interactions:[],keyboardEventTarget:this.props.allowKeyboard?document:void 0});if(this.props.allowPan!==!1&&(t.addInteraction(new o.interaction.DragPan),t.addInteraction(new o.interaction.KeyboardPan)),this.props.allowZoom!==!1&&(t.addInteraction(new o.interaction.MouseWheelZoom),t.addInteraction(new o.interaction.PinchZoom),t.addInteraction(new o.interaction.DragZoom),t.addInteraction(new o.interaction.KeyboardZoom)),t.on("singleclick",function(t){e.props.onClick&&e.props.onClick({coordinate:t.coordinate})}),t.on("moveend",r.debounce(function(){e.props.setCenter&&e.props.setCenter(t.getView().getCenter(),t.getView().getZoom())},50)),this.props.bingImagerySet?t.addLayer(new o.layer.Tile({source:new o.source.BingMaps({key:"AuPHWkNxvxVAL_8Z4G8Pcq_eOKGm5eITH_cJMNAyYoIC1S_29_HhE893YrUUbIGl",imagerySet:this.props.bingImagerySet})})):this.props.osm!==!1&&t.addLayer(new o.layer.Tile({source:new o.source.OSM})),this.props.features){var n=new o.layer.Vector({source:new o.source.Vector({features:this.props.features})});t.addLayer(n)}if(this.setState(function(e,n){return{map:t}}),this.props.layers&&this.props.layers.geoJson&&this.props.layers.geoJson.forEach(function(n){var r=a(t,n);e.props.onLayerAdd&&e.props.onLayerAdd({layer:r}),e.props.onFeatureClick&&t.on("click",function(n){if(e.props.onFeatureClick){var a=t.getFeaturesAtPixel(n.pixel);if(!a)return;if(1!==a.length)return;var i=a[0];i instanceof o.Feature&&e.props.onFeatureClick({layer:r,feature:i})}})}),this.props.controls){if(this.props.controls.draw){var i=this.props.controls.draw;(i.point||i.circle||i.line||i.polygon)&&(i.polygon&&this.addDraw(t,"Polygon"),i.circle&&this.addDraw(t,"Circle"),i.line&&this.addDraw(t,"LineString"),i.point&&this.addDraw(t,"Point"))}this.props.controls.zoom?t.addControl(new o.control.Zoom({})):this.props.controls.zoomSlider&&t.addControl(new o.control.ZoomSlider({})),this.props.controls.fullScreen&&t.addControl(new o.control.FullScreen({})),this.props.controls.mousePosition&&t.addControl(new o.control.MousePosition({coordinateFormat:function(e){return e?e.map(function(e){return e.toFixed(4)}).join(","):""},projection:"EPSG:4326"})),this.props.controls.rotate&&t.addControl(new o.control.Rotate({})),this.props.controls.scaleLine&&t.addControl(new o.control.ScaleLine({})),this.props.controls.zoomToExtent&&t.addControl(new o.control.ZoomToExtent({}))}},t.prototype.draw=function(e){this.setState(function(t){return{activeDrawingTool:t.activeDrawingTool===e?null:e}})},t.prototype.activateDrawTool=function(e){var t=this;e.getInteractions().getArray().forEach(function(e){e instanceof o.interaction.Draw&&e.setActive(e.get("type")===t.state.activeDrawingTool)})},t.prototype.addDraw=function(e,t){var n=new o.source.Vector,r=new o.layer.Vector({source:n}),a=new o.interaction.Draw({source:n,type:t});a.set("type",t),a.setActive(!1),e.addInteraction(a),e.addLayer(r)},t.prototype.componentDidUpdate=function(e,t){var n=this.state.target,r=this.state.map;r&&(r.setTarget(n),r.getView().animate({center:this.props.center||o.proj.fromLonLat([0,0]),zoom:this.props.zoom,duration:250}),this.activateDrawTool(r),this.props.trigger&&this.props.trigger!==e.trigger&&this.trigger(this.props.trigger.message,this.props.trigger.args))},t.prototype.componentWillUnmount=function(){this.setState({target:null})},t}(n.PureComponent);t.OpenLayers=s}),define("components/maplet",["require","exports","react","components/openlayers","common/common"],function(e,t,n,r,o){"use strict";t.__esModule=!0;var a=function(e){function t(t){var n=e.call(this,t)||this;return t.drawPointTest=!0,n.state=n.props,n}return __extends(t,e),t.prototype.componentDidUpdate=function(e,t){t.portrait!=this.state.portrait&&window.dispatchEvent(new Event("resize"))},t.prototype.render=function(){var e=this,t=function(t,n){e.setState({center:t,zoom:n})},a=this.state.portrait?"portrait":"landscape";return n.createElement("div",null,o.input(this),this.state.showmap&&n.createElement("div",null,n.createElement("div",null,n.createElement("label",null,this.state.center.map(function(e){return e.toFixed(5)}).join(",")," Z",this.state.zoom)),n.createElement(r.OpenLayers,{orientation:a,controls:{draw:{point:this.state.drawPointTest},zoom:!0,zoomToExtent:!0},setCenter:t,center:this.state.center,zoom:this.state.zoom,osm:!1}),n.createElement(r.OpenLayers,{orientation:a,controls:{mousePosition:!0,draw:{point:this.state.drawPointTest}},bingImagerySet:"AerialWithLabels",setCenter:t,center:this.state.center,zoom:this.state.zoom,layers:{geoJson:["http://openlayers.org/en/master/examples/data/geojson/countries.geojson"]}}),n.createElement(r.OpenLayers,{orientation:a,controls:{fullScreen:!0,draw:{point:this.state.drawPointTest}},bingImagerySet:"Aerial",setCenter:t,center:this.state.center,zoom:this.state.zoom,layers:{geoJson:["https://gist.githubusercontent.com/ca0v/78c82dbcb184d52f784a9aa11a452272/raw/5929e9469e02363665017202394aabba906845ae/trip.geojson"]}}),n.createElement(r.OpenLayers,{orientation:a,allowPan:!1,allowZoom:!1,controls:{scaleLine:!0,draw:{circle:!0,line:!0,point:!0,polygon:!0}},osm:!0,setCenter:t,center:this.state.center,zoom:this.state.zoom})))},t}(n.PureComponent);t.Maplet=a}),define("components/quizlet",["require","exports","components/openlayers","react","common/common","openlayers"],function(e,t,n,r,o,a){"use strict";t.__esModule=!0;var i,s={right:function(e){return function(t,n){return new a.style.Style({fill:new a.style.Fill({color:[0,128,0,.5]}),text:new a.style.Text({text:"âœ” "+t.get(e.props.featureNameFieldName),scale:1}),stroke:new a.style.Stroke({color:[20,200,200,1],width:2})})}},wrong:function(e){return function(t,n){return new a.style.Style({fill:new a.style.Fill({color:[255,0,0,.5]}),text:new a.style.Text({text:t.get(e.props.featureNameFieldName),scale:5}),stroke:new a.style.Stroke({color:[200,20,200,1],width:2})})}},indeterminate:function(e){return function(t,n){var r=t.get(e.props.featureNameFieldName),o=e.state.hint&&1<e.state.hint,i=e.state.hint&&2<e.state.hint&&e.state.answer===r;return new a.style.Style({text:new a.style.Text({text:o?r:"",scale:1,stroke:new a.style.Stroke({color:[200,200,200,1],width:2})}),stroke:new a.style.Stroke({color:i?[200,20,200,1]:[20,20,200,1],width:i?e.state.hint:1})})}}},c=function(e){function t(t){var n=e.call(this,t)||this;return n.state={answer:"Click the map to Begin!",center:[0,0],zoom:1,score:0,features:new a.Collection},n}return __extends(t,e),t.prototype.render=function(){var e=this;return r.createElement("div",{className:"quizlet"},r.createElement(n.OpenLayers,{trigger:this.state.mapTrigger,allowKeyboard:!0,orientation:"full",center:this.state.center,zoom:this.state.zoom,controls:{mousePosition:!0},bingImagerySet:"Aerial",layers:{geoJson:[this.props.geojsonUrl]},setCenter:function(t,n){e.setState(function(){return{center:t,zoom:n}})},onFeatureClick:function(t){if(i&&i.length)if(e.test(t.feature))e.state.features.push(t.feature);else{var n=e.find();n&&e.state.features.push(n)}else{var r=t.feature.get(e.props.featureNameFieldName);e.init(t.layer,{firstLetter:r[0]}),e.zoomToFeature(t.feature),e.next()}}},r.createElement(n.OpenLayers,{className:"inset",osm:!1,center:this.state.center,zoom:Math.max(0,this.state.zoom-5),allowZoom:!0,allowPan:!0,orientation:"landscape",onClick:function(t){e.setState(function(e){return{center:t.coordinate}})},layers:{geoJson:["./data/countries.json"]},features:this.state.features})),r.createElement("div",{className:"score"},"Score",r.createElement("label",null,this.state.score," ",i&&i.length+" remaining")),r.createElement("div",{className:"score"},"Remaining",r.createElement("label",null,i?i.length:"?")),r.createElement("div",{className:"score"},"Find",r.createElement("label",null,this.state.answer)),r.createElement("br",null)," ",r.createElement("div",{className:"score"},r.createElement("button",{onClick:function(){return e.skip()}},"Skip"),r.createElement("button",{onClick:function(){return e.hint()}},"Hint")))},t.prototype.skip=function(){this.score(-1),this.state.answer&&i.unshift(this.state.answer),this.next()},t.prototype.score=function(e){this.setState(function(t){return{score:t.score+e}})},t.prototype.init=function(e,t){var n=this,r=e.getSource(),a=this.props.featureNameFieldName,c=r.getFeatures();c.forEach(function(e){return e.setStyle(s.indeterminate(n))}),i=c.map(function(e){return e.get(a)}),t&&t.firstLetter&&(i=i.filter(function(e){return 0===e.indexOf(t.firstLetter)})),o.shuffle(i),this.setState(function(t){return{layer:e,score:t.score||0}}),document.addEventListener("keypress",function(e){switch(e.key.toUpperCase()){case"H":n.hint();break;case"S":n.skip()}})},t.prototype.test=function(e){var t=this,n=this.props.featureNameFieldName,r=e.get(n)===this.state.answer;if(r)this.score(20),e.setStyle(s.right(this)),this.next();else{this.score(-20);var o=this.find();o&&(o.setStyle(s.wrong(this)),this.zoomToFeature(o),this.state.answer&&i.unshift(this.state.answer),setTimeout(function(){return t.next()},2500))}return r},t.prototype.zoomToFeature=function(e){var t=e.getGeometry().getExtent();this.setState(function(e){return{mapTrigger:{message:"extent",args:{extent:t}}}})},t.prototype.next=function(){i.length&&this.setState(function(e){return{answer:i.pop(),hint:0}})},t.prototype.find=function(){var e=this;if(this.state.layer){var t=this.state.layer.getSource();if(t){var n=t.getFeatures().filter(function(t){return t.get(e.props.featureNameFieldName)===e.state.answer});if(n&&1===n.length){var r=n[0];return r}return null}}},t.prototype.hint=function(){var e=this.find();if(e){var t=a.extent.getCenter(e.getGeometry().getExtent());this.setState(function(e){return{score:e.score-5,hint:(e.hint||0)+1,center:t,zoom:Math.min(Math.max(5,e.zoom+1),6),mapTrigger:{message:"refresh"}}})}},t}(r.PureComponent);t.QuizletComponent=c}),define("app",["require","exports","react","components/quizlet"],function(e,t,n,r){"use strict";t.__esModule=!0;var o=function(e){function t(t){var n=e.call(this,t)||this;return n.state={orientation:"landscape",url:"./data/countries.json"},n}return __extends(t,e),t.prototype.render=function(){return n.createElement("div",{className:"app"},n.createElement("title",null,"React + Openlayers Lab"),n.createElement(r.QuizletComponent,{geojsonUrl:this.state.url,featureNameFieldName:"name"}))},t}(n.PureComponent);t.App=o}),define("index",["require","exports","react","react-dom","app"],function(e,t,n,r,o){"use strict";function a(){r.render(n.createElement(o.App,{showmap:!0,center:[-82.408,34.789],zoom:12}),document.querySelector("app"))}return a}),define("components/index",["require","exports","react"],function(e,t,n){"use strict";t.__esModule=!0;var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(n.PureComponent);t.IndexComponent=r});
//# sourceMappingURL=index.js.map